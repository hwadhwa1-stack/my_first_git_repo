<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ShopX — One‑File E‑Commerce</title>
  <meta name="description" content="A beautiful single-file e‑commerce site with catalog, cart, wishlist, coupons, and mock checkout.">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0b0d10;--panel:#111418;--panel-2:#141821;--text:#e7ebf3;--muted:#aeb6c8;--brand:#6c8bff;--brand-2:#8a7bff;--ok:#42d392;--danger:#ff6b6b;--warning:#ffb020;--chip:#23283a;--chip-2:#1a1f2d;--ring:rgba(108,139,255,.5);--shadow:0 10px 30px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.02)
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:linear-gradient(180deg,var(--bg),#0d1117 50%, #0b0d10);color:var(--text)}
    a{color:inherit;text-decoration:none}
    .container{max-width:1200px;margin:0 auto;padding:24px}
    header{position:sticky;top:0;z-index:30;background:rgba(11,13,16,.7);backdrop-filter:blur(10px);border-bottom:1px solid #1a2230}
    .nav{display:flex;gap:16px;align-items:center;justify-content:space-between;padding:14px 24px}
    .brand{display:flex;align-items:center;gap:12px;font-weight:800;letter-spacing:.3px}
    .badge{font-size:11px;padding:4px 8px;border-radius:999px;background:linear-gradient(135deg,var(--brand),var(--brand-2));color:#fff}
    .search{flex:1;max-width:560px;position:relative}
    .search input{width:100%;background:#0e1220;border:1px solid #1b2233;color:var(--text);padding:12px 44px 12px 44px;border-radius:14px;outline:none;transition:.2s}
    .search input:focus{border-color:var(--brand);box-shadow:0 0 0 4px var(--ring)}
    .search svg{position:absolute;left:12px;top:50%;transform:translateY(-50%);opacity:.6}
    .pillbar{display:flex;gap:10px;overflow:auto;padding:0 24px 16px}
    .chip{background:var(--chip);border:1px solid #293249;padding:8px 12px;border-radius:999px;font-size:13px;cursor:pointer;white-space:nowrap}
    .chip.active{background:linear-gradient(180deg,#1a2140,#151a2e);border-color:#42528a;color:#cfe0ff}
    .controls{display:flex;gap:12px;align-items:center}
    select, .btn{background:#0d1220;border:1px solid #26314d;color:var(--text);padding:10px 12px;border-radius:12px}
    .btn{cursor:pointer;transition:.2s;display:inline-flex;gap:8px;align-items:center}
    .btn:hover{border-color:#3a4d7a;box-shadow:0 0 0 3px rgba(66,82,138,.2)}
    .grid{display:grid;grid-template-columns:repeat(4,1fr);gap:18px}
    @media(max-width:1000px){.grid{grid-template-columns:repeat(3,1fr)}}
    @media(max-width:720px){.grid{grid-template-columns:repeat(2,1fr)}.controls{flex-wrap:wrap}}
    @media(max-width:480px){.grid{grid-template-columns:1fr}}
    .card{background:linear-gradient(180deg,var(--panel),var(--panel-2));border:1px solid #1a2230;border-radius:18px;overflow:hidden;box-shadow:var(--shadow);display:flex;flex-direction:column}
    .thumb{position:relative;aspect-ratio:4/3;overflow:hidden}
    .thumb img{width:100%;height:100%;object-fit:cover;display:block;transform:scale(1);transition:transform .35s ease}
    .card:hover .thumb img{transform:scale(1.06)}
    .chip-mini{position:absolute;left:12px;top:12px;background:#0f1424;border:1px solid #273154;color:#cfe0ff;font-size:11px;padding:6px 10px;border-radius:999px}
    .wish{position:absolute;right:12px;top:12px;background:#0f1424;border:1px solid #273154;border-radius:999px;padding:8px;display:grid;place-items:center;cursor:pointer}
    .body{padding:14px 14px 16px;display:flex;flex-direction:column;gap:10px}
    .title{font-weight:700}
    .price{display:flex;gap:8px;align-items:baseline}
    .strike{text-decoration:line-through;color:#7b86a3;font-size:13px}
    .add{margin-top:auto}
    .add .btn{width:100%;justify-content:center}
    .stars{font-size:12px;color:#ffd76a}
    .empty{opacity:.7;text-align:center;padding:24px}

    /* Cart Drawer */
    .drawer{position:fixed;inset:0 0 0 auto;width:min(430px,100%);transform:translateX(105%);transition:transform .3s ease;background:linear-gradient(180deg,#0d1220,#0b0f1a);border-left:1px solid #1a2230;z-index:50;display:flex;flex-direction:column}
    .drawer.open{transform:translateX(0)}
    .drawer-head{display:flex;align-items:center;justify-content:space-between;padding:16px 18px;border-bottom:1px solid #1a2230}
    .cart-items{flex:1;overflow:auto;display:flex;flex-direction:column;gap:12px;padding:16px}
    .cart-row{display:grid;grid-template-columns:64px 1fr auto;gap:12px;align-items:center;background:#0f1424;border:1px solid #222b3f;border-radius:14px;padding:8px}
    .qty{display:flex;gap:8px;align-items:center}
    .qty button{width:28px;height:28px;border-radius:8px;border:1px solid #2a3554;background:#11172a;color:var(--text);cursor:pointer}
    .remove{background:none;border:none;color:var(--danger);cursor:pointer}
    .totals{border-top:1px dashed #243152;padding:16px;display:flex;flex-direction:column;gap:8px}
    .checkout{padding:16px;border-top:1px solid #1a2230}
    .input{width:100%;background:#0e1220;border:1px solid #1b2233;color:var(--text);padding:10px 12px;border-radius:12px}
    .inline{display:flex;gap:10px}

    /* Modal */
    .modal{position:fixed;inset:0;background:rgba(0,0,0,.5);backdrop-filter:blur(2px);display:none;place-items:center;z-index:60}
    .modal.open{display:grid}
    .sheet{width:min(900px,96vw);display:grid;grid-template-columns:1fr 1fr;background:linear-gradient(180deg,#0f1424,#0c111d);border:1px solid #1a2230;border-radius:18px;overflow:hidden}
    @media(max-width:860px){.sheet{grid-template-columns:1fr}}
    .sheet .left{aspect-ratio:4/3;background:#0b0f1a;display:grid;place-items:center}
    .sheet .left img{width:100%;height:100%;object-fit:cover}
    .sheet .right{padding:18px;display:flex;flex-direction:column;gap:12px}

    .footer{border-top:1px solid #1a2230;margin-top:18px;padding:22px;text-align:center;color:#95a1bd}
    .tag{font-size:12px;padding:4px 8px;border-radius:999px;background:#0e1426;border:1px solid #263257}
  </style>
</head>
<body>
  <header>
    <div class="nav container">
      <div class="brand">
        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 2l3.5 6h6.5l-5.25 4 2 7-6.75-4.5L5.5 19l2-7L2.25 8H8.5L12 2z" fill="url(#g)"/><defs><linearGradient id="g" x1="0" y1="0" x2="24" y2="24"><stop stop-color="#6c8bff"/><stop offset="1" stop-color="#8a7bff"/></linearGradient></defs></svg>
        <span>ShopX</span>
        <span class="badge">One‑File</span>
      </div>
      <div class="search">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M21 21l-4.35-4.35M10.5 18a7.5 7.5 0 1 1 0-15 7.5 7.5 0 0 1 0 15z" stroke="#9fb0d4" stroke-width="1.5" stroke-linecap="round"/></svg>
        <input id="search" type="text" placeholder="Search products, brands, categories…"/>
      </div>
      <div class="controls">
        <select id="sort">
          <option value="pop">Sort: Popular</option>
          <option value="low">Price: Low → High</option>
          <option value="high">Price: High → Low</option>
          <option value="new">Newest</option>
          <option value="rate">Top Rated</option>
        </select>
        <button class="btn" id="wishlistBtn" title="Wishlist">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12.1 20s-7.6-4.3-9.3-8.4C1.4 9.5 2.8 6.2 6.2 6 8 5.9 9.4 7 10 8.2 10.6 7 12 5.9 13.8 6c3.4.2 4.8 3.5 3.4 5.6-1.7 4.1-9.1 8.4-9.1 8.4z" stroke="#cfe0ff" stroke-width="1.3" fill="none"/></svg>
          Wishlist
        </button>
        <button class="btn" id="cartBtn" title="Open cart">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3 3h2l2.5 12.5a2 2 0 0 0 2 1.5h7a2 2 0 0 0 2-1.5L21 7H6" stroke="#cfe0ff" stroke-width="1.3" stroke-linecap="round"/><circle cx="10" cy="20" r="1.4" fill="#cfe0ff"/><circle cx="17" cy="20" r="1.4" fill="#cfe0ff"/></svg>
          Cart (<span id="cartCount">0</span>)
        </button>
      </div>
    </div>
    <div class="pillbar" id="categories"></div>
  </header>

  <main class="container">
    <div class="grid" id="grid"></div>
    <div class="empty" id="emptyState" style="display:none;">No products match your search or filters.</div>
    <div class="footer">© <span id="year"></span> ShopX · Demo store · <span class="tag">Single‑file template</span> <span class="tag">LocalStorage</span> <span class="tag">Mock checkout</span></div>
  </main>

  <!-- Cart Drawer -->
  <aside class="drawer" id="drawer">
    <div class="drawer-head">
      <strong>Your Cart</strong>
      <button class="btn" id="closeCart">Close</button>
    </div>
    <div class="cart-items" id="cartItems"></div>
    <div class="totals">
      <div style="display:flex;justify-content:space-between"><span>Subtotal</span><span id="tSubtotal">₹0</span></div>
      <div style="display:flex;justify-content:space-between"><span>Discount</span><span id="tDiscount">-₹0</span></div>
      <div style="display:flex;justify-content:space-between"><span>Shipping</span><span id="tShipping">₹0</span></div>
      <div style="display:flex;justify-content:space-between"><span>Tax (10%)</span><span id="tTax">₹0</span></div>
      <div style="display:flex;justify-content:space-between;font-weight:700"><span>Total</span><span id="tTotal">₹0</span></div>
    </div>
    <div class="checkout">
      <div class="inline" style="margin-bottom:10px">
        <input class="input" id="coupon" placeholder="Coupon code (SAVE10, FREESHIP)" />
        <button class="btn" id="applyCoupon">Apply</button>
      </div>
      <details>
        <summary style="cursor:pointer;margin-bottom:10px">Proceed to checkout</summary>
        <form id="checkoutForm">
          <input class="input" placeholder="Full name" required style="margin-bottom:8px"/>
          <input class="input" placeholder="Email" type="email" required style="margin-bottom:8px"/>
          <input class="input" placeholder="Address" required style="margin-bottom:8px"/>
          <div class="inline">
            <input class="input" placeholder="Card number" required/>
            <input class="input" placeholder="MM/YY" required/>
            <input class="input" placeholder="CVC" required/>
          </div>
          <button class="btn" style="width:100%;margin-top:10px">Pay now</button>
        </form>
      </details>
    </div>
  </aside>

  <!-- Product Modal -->
  <div class="modal" id="modal">
    <div class="sheet">
      <div class="left"><img id="mImg" alt=""/></div>
      <div class="right">
        <div class="tag" id="mCategory"></div>
        <h2 id="mTitle" style="margin:8px 0"></h2>
        <div class="stars" id="mStars"></div>
        <p id="mDesc" style="color:#b7c2de"></p>
        <div class="price"><strong id="mPrice"></strong> <span class="strike" id="mCompare"></span></div>
        <div class="inline">
          <button class="btn" id="mAdd">Add to cart</button>
          <button class="btn" id="mWish">♡ Wishlist</button>
          <button class="btn" id="mClose">Close</button>
        </div>
      </div>
    </div>
  </div>

<script>
// ===== Utilities =====
const $ = (s)=>document.querySelector(s);
const $$ = (s)=>document.querySelectorAll(s);
const fmt = (n)=> new Intl.NumberFormat('en-IN',{style:'currency',currency:'INR',maximumFractionDigits:0}).format(n);
const save = (k,v)=> localStorage.setItem(k, JSON.stringify(v));
const load = (k,d)=> { try { return JSON.parse(localStorage.getItem(k)) ?? d } catch { return d } };
const clamp=(n,min,max)=>Math.max(min,Math.min(max,n));

// ===== Data =====
const PRODUCTS = [
  {id:1, title:'Aurora Wireless Headphones', price:3499, compare:4999, rating:4.7, reviews:812, cat:'Audio', img:'https://images.unsplash.com/photo-1518443758784-0e5f0e7adf5c?q=80&w=1200&auto=format&fit=crop', desc:'Immersive sound with active noise canceling and 40h battery.'},
  {id:2, title:'Nimbus Smartwatch S3', price:5999, compare:7499, rating:4.5, reviews:1203, cat:'Wearables', img:'https://images.unsplash.com/photo-1524805444758-089113d48a6d?q=80&w=1200&auto=format&fit=crop', desc:'AMOLED display, GPS, SpO2, sleep tracking, and 5ATM water resistance.'},
  {id:3, title:'Vortex Mechanical Keyboard', price:4299, compare:5299, rating:4.6, reviews:657, cat:'Computers', img:'https://images.unsplash.com/photo-1517336714731-489689fd1ca8?q=80&w=1200&auto=format&fit=crop', desc:'Hot‑swappable switches, per‑key RGB, and aluminum top plate.'},
  {id:4, title:'Stellar 4K Action Cam', price:7999, compare:9999, rating:4.4, reviews:344, cat:'Cameras', img:'https://images.unsplash.com/photo-1519183071298-a2962be96f83?q=80&w=1200&auto=format&fit=crop', desc:'Stabilized 4K60 video, waterproof up to 10m, with voice control.'},
  {id:5, title:'Pulse Fitness Tracker', price:2499, compare:2999, rating:4.2, reviews:980, cat:'Wearables', img:'https://images.unsplash.com/photo-1555685812-4b943f1cb0eb?q=80&w=1200&auto=format&fit=crop', desc:'Lightweight tracker with heart‑rate, steps, and guided workouts.'},
  {id:6, title:'Echo Mini Speaker', price:1799, compare:2199, rating:4.1, reviews:2032, cat:'Audio', img:'https://images.unsplash.com/photo-1546435770-a3e426bf472b?q=80&w=1200&auto=format&fit=crop', desc:'Room‑filling sound in a compact form with Bluetooth 5.2.'},
  {id:7, title:'Photon LED Desk Lamp', price:1399, compare:1699, rating:4.8, reviews:412, cat:'Home', img:'https://images.unsplash.com/photo-1541807084-5c52b6b3adef?q=80&w=1200&auto=format&fit=crop', desc:'Adjustable color temperature, USB‑C charging, and auto‑dim sensor.'},
  {id:8, title:'Trailblazer Backpack 28L', price:2999, compare:3499, rating:4.6, reviews:149, cat:'Travel', img:'https://images.unsplash.com/photo-1500530855697-b586d89ba3ee?q=80&w=1200&auto=format&fit=crop', desc:'Weather‑resistant, laptop sleeve, and ergonomic straps.'},
  {id:9, title:'Zen Brew Coffee Maker', price:3699, compare:4499, rating:4.3, reviews:532, cat:'Home', img:'https://images.unsplash.com/photo-1498804103079-a6351b050096?q=80&w=1200&auto=format&fit=crop', desc:'Programmable brewer with thermal carafe and bloom pre‑infuse.'},
  {id:10, title:'Aero True Wireless Buds', price:2699, compare:3299, rating:4.4, reviews:1112, cat:'Audio', img:'https://images.unsplash.com/photo-1590658268037-6bf12165a8df?q=80&w=1200&auto=format&fit=crop', desc:'ANC earbuds with low‑latency and wireless charging case.'},
  {id:11, title:'HyperX Portable SSD 1TB', price:6999, compare:8999, rating:4.7, reviews:220, cat:'Computers', img:'https://images.unsplash.com/photo-1517336714731-489689fd1ca8?q=80&w=1200&auto=format&fit=crop', desc:'USB‑C 10Gbps speeds with rugged shock‑resistant casing.'},
  {id:12, title:'Orbit Drone Mini', price:4599, compare:5799, rating:4.0, reviews:321, cat:'Cameras', img:'https://images.unsplash.com/photo-1473968512647-3e447244af8f?q=80&w=1200&auto=format&fit=crop', desc:'Foldable drone with 2K camera and gesture control.'}
];

// ===== State =====
let state = {
  q: '',
  cat: 'All',
  sort: 'pop',
  wishlist: load('wishlist', []),
  cart: load('cart', []),
  coupon: load('coupon', null)
};

// ===== Render Helpers =====
const stars = (n)=> '★★★★★☆☆☆☆☆'.slice(5-Math.round(n)) .slice(0,5);
function renderCategories(){
  const cats = ['All', ...new Set(PRODUCTS.map(p=>p.cat))];
  $('#categories').innerHTML = cats.map(c=><button class="chip ${state.cat===c?'active':''}" data-cat="${c}">${c}</button>).join('');
  $$('#categories .chip').forEach(b=> b.onclick = ()=>{ state.cat=b.dataset.cat; render(); });
}

function card(p){
  const wished = state.wishlist.includes(p.id);
  return `<article class="card">
    <div class="thumb" role="button" aria-label="Open ${p.title}" data-open="${p.id}">
      <img src="${p.img}" alt="${p.title}">
      <span class="chip-mini">${p.cat}</span>
      <button class="wish" data-wish="${p.id}" title="${wished?'Remove from':'Add to'} wishlist">${wished? '❤️':'♡'}</button>
    </div>
    <div class="body">
      <div class="title">${p.title}</div>
      <div class="stars">${'★'.repeat(Math.round(p.rating))}${'☆'.repeat(5-Math.round(p.rating))} <span style="color:#9fb0d4">(${p.reviews})</span></div>
      <div class="price"><strong>${fmt(p.price)}</strong> <span class="strike">${fmt(p.compare)}</span></div>
      <div class="add"><button class="btn" data-add="${p.id}">Add to cart</button></div>
    </div>
  </article>`;
}

function applyFilters(list){
  const q = state.q.toLowerCase();
  let out = list.filter(p =>
    (state.cat==='All' || p.cat===state.cat) &&
    (p.title.toLowerCase().includes(q) || p.desc.toLowerCase().includes(q))
  );
  switch(state.sort){
    case 'low': out.sort((a,b)=>a.price-b.price); break;
    case 'high': out.sort((a,b)=>b.price-a.price); break;
    case 'new': out = out.reverse(); break;
    case 'rate': out.sort((a,b)=>b.rating-a.rating); break;
    default: out.sort((a,b)=>b.reviews-a.reviews);
  }
  return out;
}

function renderGrid(){
  const list = applyFilters([...PRODUCTS]);
  $('#grid').innerHTML = list.map(card).join('');
  $('#emptyState').style.display = list.length? 'none':'block';

  // Attach item actions
  $$('[data-add]').forEach(b=> b.onclick = ()=> addToCart(+b.dataset.add));
  $$('[data-open]').forEach(el=> el.onclick = (e)=>{ if(e.target.closest('.wish')) return; openModal(+el.dataset.open); });
  $$('[data-wish]').forEach(b=> b.onclick = (e)=>{ e.stopPropagation(); toggleWish(+b.dataset.wish); });
}

function renderCart(){
  const items = state.cart.map(row=>{
    const p = PRODUCTS.find(x=>x.id===row.id);
    return { ...row, ...p, lineTotal: row.qty * p.price };
  });
  $('#cartItems').innerHTML = items.length ? items.map(it=>`
    <div class="cart-row">
      <img src="${it.img}" alt="" style="width:64px;height:64px;object-fit:cover;border-radius:10px">
      <div>
        <div style="font-weight:600">${it.title}</div>
        <div style="color:#9fb0d4;font-size:13px">${it.cat}</div>
        <div class="qty" style="margin-top:6px">
          <button data-dec="${it.id}">-</button>
          <span>${it.qty}</span>
          <button data-inc="${it.id}">+</button>
          <button class="remove" data-rem="${it.id}">Remove</button>
        </div>
      </div>
      <div style="font-weight:600">${fmt(it.lineTotal)}</div>
    </div>).join('') : `<div class="empty">Your cart is empty.</div>;

  // totals
  const subtotal = items.reduce((a,b)=>a+b.lineTotal,0);
  const discount = calcDiscount(subtotal);
  const shipping = subtotal - discount >= 4999 || state.coupon==='FREESHIP' ? 0 : 199;
  const tax = Math.round((subtotal - discount + shipping) * 0.10);
  const total = subtotal - discount + shipping + tax;
  $('#tSubtotal').textContent = fmt(subtotal);
  $('#tDiscount').textContent = '-'+fmt(discount);
  $('#tShipping').textContent = fmt(shipping);
  $('#tTax').textContent = fmt(tax);
  $('#tTotal').textContent = fmt(total);

  // count
  const count = state.cart.reduce((a,b)=>a+b.qty,0);
  $('#cartCount').textContent = count;

  // actions
  $$('[data-inc]').forEach(b=> b.onclick = ()=> changeQty(+b.dataset.inc, +1));
  $$('[data-dec]').forEach(b=> b.onclick = ()=> changeQty(+b.dataset.dec, -1));
  $$('[data-rem]').forEach(b=> b.onclick = ()=> removeFromCart(+b.dataset.rem));
}

function calcDiscount(subtotal){
  if(state.coupon==='SAVE10') return Math.round(subtotal*0.10);
  return 0;
}

function render(){
  renderCategories();
  renderGrid();
  renderCart();
}

// ===== Actions =====
function toggleWish(id){
  const i = state.wishlist.indexOf(id);
  if(i>-1) state.wishlist.splice(i,1); else state.wishlist.push(id);
  save('wishlist', state.wishlist);
  renderGrid();
}

function addToCart(id, qty=1){
  const row = state.cart.find(r=>r.id===id);
  if(row) row.qty = clamp(row.qty+qty,1,99); else state.cart.push({id,qty});
  save('cart', state.cart); renderCart();
  openDrawer();
}
function changeQty(id,delta){
  const row = state.cart.find(r=>r.id===id);
  if(!row) return; row.qty = clamp(row.qty+delta,0,99);
  if(row.qty===0) state.cart = state.cart.filter(r=>r.id!==id);
  save('cart', state.cart); renderCart();
}
function removeFromCart(id){ state.cart = state.cart.filter(r=>r.id!==id); save('cart', state.cart); renderCart(); }

function openDrawer(){ $('#drawer').classList.add('open'); }
function closeDrawer(){ $('#drawer').classList.remove('open'); }

function openModal(id){
  const p = PRODUCTS.find(x=>x.id===id); if(!p) return;
  $('#mImg').src = p.img; $('#mTitle').textContent = p.title; $('#mDesc').textContent = p.desc; $('#mPrice').textContent = fmt(p.price); $('#mCompare').textContent = fmt(p.compare); $('#mCategory').textContent = p.cat; $('#mStars').textContent = '★'.repeat(Math.round(p.rating))+' '+p.rating.toFixed(1)+' · '+p.reviews+' reviews';
  $('#mAdd').onclick = ()=> addToCart(p.id);
  $('#mWish').textContent = state.wishlist.includes(p.id)?'♥ Wishlisted':'♡ Wishlist';
  $('#mWish').onclick = ()=> { toggleWish(p.id); openModal(p.id); };
  $('#modal').classList.add('open');
}
function closeModal(){ $('#modal').classList.remove('open'); }

// ===== Events =====
$('#search').addEventListener('input', e=>{ state.q = e.target.value; renderGrid(); });
$('#sort').addEventListener('change', e=>{ state.sort = e.target.value; renderGrid(); });
$('#cartBtn').onclick = openDrawer; $('#closeCart').onclick = closeDrawer; $('#drawer').addEventListener('click', e=>{ if(e.target===e.currentTarget) closeDrawer(); });
$('#modal').addEventListener('click', e=>{ if(e.target===e.currentTarget) closeModal(); });
$('#mClose').onclick = closeModal;

$('#applyCoupon').onclick = ()=>{
  const code = $('#coupon').value.trim().toUpperCase();
  if(['SAVE10','FREESHIP'].includes(code)) { state.coupon = code; save('coupon', code); alert('Coupon applied: '+code); }
  else { state.coupon = null; save('coupon', null); alert('Invalid coupon'); }
  renderCart();
};

$('#checkoutForm').addEventListener('submit', (e)=>{
  e.preventDefault();
  const orderId = 'ORD-'+Math.random().toString(36).slice(2,8).toUpperCase();
  alert('✅ Payment simulated!\nOrder '+orderId+' confirmed. A receipt has been emailed.');
  state.cart=[]; save('cart', state.cart); renderCart(); closeDrawer();
});

$('#wishlistBtn').onclick = ()=>{
  const ids = state.wishlist;
  if(!ids.length) return alert('Your wishlist is empty. Tap the ♥ on any product to add it.');
  const names = PRODUCTS.filter(p=>ids.includes(p.id)).map(p=> '• '+p.title).join('\n');
  alert('Wishlist (local):\n\n'+names);
};

// Init
$('#year').textContent = new Date().getFullYear();
if(state.coupon) $('#coupon').value = state.coupon;
render();
</script>
</body>
</html>